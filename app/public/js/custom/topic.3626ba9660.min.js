function onEditTopic(e){window.location.href=`/topic/${e}/edit`}function onDelTopic(e){confirm("确定要删除此话题吗？")&&$.post(`/topic/${e}/del`,{_csrf:getCsrf()},e=>{0==e.code&&(window.location.href="/home")})}function onCollectTopic(e){$.post("/topic/collect",{id:e,_csrf:getCsrf()},e=>{if(0==e.code){const r=$("#myCollectBtn");"add"==e.action?(r.addClass("btn-muted"),r.removeClass("btn-primary"),r.text("取消收藏")):(r.addClass("btn-primary"),r.removeClass("btn-muted"),r.text("收藏"))}})}function onSetTopTopic(e){$.post("/topic/top",{id:e,_csrf:getCsrf()},e=>{if(0==e.code){const r=$("#myTopBtn");1==e.data?(r.addClass("btn-muted"),r.removeClass("btn-primary"),r.text("取消置顶")):(r.addClass("btn-primary"),r.removeClass("btn-muted"),r.text("置顶"))}})}function onSetGoodTopic(e){$.post("/topic/good",{id:e,_csrf:getCsrf()},e=>{if(0==e.code){const r=$("#myGoodBtn");1==e.data?(r.addClass("btn-muted"),r.removeClass("btn-primary"),r.text("取消精华")):(r.addClass("btn-primary"),r.removeClass("btn-muted"),r.text("精华"))}})}function onLikeReply(e){const r=$(event.target),t=$(`#like_text_${e}`);$.post("/reply/like",{id:e,_csrf:getCsrf()},e=>{0==e.code&&(t.removeClass("d-none"),"up"==e.action?(r.addClass("fas"),r.removeClass("far")):(r.addClass("far"),r.removeClass("fas")),t.text(e.data))})}function getCsrf(){let e=document.cookie.match("(^|;) ?csrfToken=([^;]*)(;|$)");return e?e[2]:null}function onEditReply(e){window.location.href=`/reply/${e}/edit`}function onDelReply(e,r){confirm("确定要删除此回复吗？")&&$.post("/reply/del",{id:e,_csrf:getCsrf()},e=>{0==e.code&&(window.location.href=`/topic/${r}`)})}let replyUserWrapper,replyUserFormElement,replyUserParentElement,replyUserEditor,replyTriggerList;function onUserReply(e,r,t){if(!replyUserEditor){replyUserWrapper=$('<form id="newForm" method="post" novalidate/>'),replyUserFormElement=replyUserWrapper[0];const e=$('<div class="form-group" style="position: relative;"></div>'),r=$('<textarea id="newTextarea" class="form-control" name="content" required>');e.append(r),replyUserTextareaElement=r[0];const t=$('<div class="invalid-feedback">请正确填写回复内容，要求字数1字以上。</div>');e.append(t),replyUserWrapper.append(e);const o=$('<button class="btn btn-primary" style="cursor: pointer;" type="submit">回复</button>');replyUserWrapper.append(o),o.click(function(){checkForm("newForm","newTextarea",replyUserEditor)||(event.preventDefault(),event.stopPropagation())});const n=$('<input type="hidden" name="parent"/>');replyUserWrapper.append(n),replyUserParentElement=n[0];const s=$('<input type="hidden" name="_csrf"/>');replyUserWrapper.append(s),replyUserCSRFElement=s[0],replyUserCSRFElement.value=getCsrf(),(replyUserEditor=new Editor({element:replyUserTextareaElement,status:!1})).render(),replyUsernamesSet&&(replyTriggerList=new EditorCharTriggeringList(replyUserEditor.codemirror,replyUsernamesSet)).activate()}replyUserFormElement.action=`/topic/${r}/reply`,replyUserParentElement.value=e,$("#userReplyContainer_"+e).append(replyUserWrapper),replyUserEditor.codemirror.doc.setValue(`@${t} `),replyUserEditor.codemirror.doc.setCursor(999,999),replyUserEditor.codemirror.doc.cm.focus()}