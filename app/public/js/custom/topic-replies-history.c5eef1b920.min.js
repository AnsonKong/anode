const list=$("#replies-history-list");let timeoutFlag;function getParentIds(t,e){const i=t.attr("parent-id");if(i){const t=$("#"+i);t.length&&(e.unshift(i),getParentIds(t,e))}}function buildRepliesHistory(t){list.empty();const e=list.get(0).parentNode;e&&e.removeChild(list.get(0));const i=$('<li class="list-group-item bg-info text-white text-center">对话历史</li>');list.append(i);for(let e=0;e<t.length;e++){let i=$("#"+t[e]+" .reply-content").get(0).innerText,n=$("#"+t[e]+" .reply-avatar-container").get(0).cloneNode(!0);$(n).attr("target","_blank"),$(n).css("text-decoration","none");let s=$(`<li class="list-group-item">${n.outerHTML}${filterXSS(i)}<a href="#${t[e]}">↑</a></li>`);list.append(s)}}list.hover(function(){clearTimeout(timeoutFlag)},function(){list.fadeOut()}),$(".replies-history-btn").hover(function(){clearTimeout(timeoutFlag);const t=$(this).parents("li[parent-id]");if(t.length){const e=[];if(getParentIds(t,e),e.length){buildRepliesHistory(e);const t=$(event.target);t.parent().append(list);const i=t.position().left+t.width()+10,n=t.position().top;list.css("left",i),list.css("top",n),list.fadeIn()}}},function(){timeoutFlag=setTimeout(function(){list.fadeOut()},500)});